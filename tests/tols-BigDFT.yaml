---
Default tolerances:
 Epsilon: 1.1e-11
 
Keys to ignore:
 - Code logo
 - MPI task*
 - Timings for root process
 - Maximal OpenMP threads per MPI task
 - OpenMP threads per task
 - OpenMP parallelization
 - Memory* 
 - Orbitals Repartition*
 - Rho Commun
 - Total number of components
 - GPU acceleration
 - High Res. box is treated separately
 - Grid Spacing threshold (AU)
 - Direct and transposed data repartition
 - Write Waves Time
 - Reading Waves Time
 - Maxdiff*
 - Tolerances for this check
 - Material acceleration
 - Number of OpenCL devices per node
 - Version Number
 - Root process Hostname
 - Input ixc parameter corresponds to XC
 - Wavefunction written No.
Patterns to ignore:
 - Timestamp
 - memory
 - FLAGS

Expected Test CPUtime: #
 C: #[expected, error]
  athelas: [ 6.0, 1.0 ]

yaml_test:
 Tax: 1.8e-6
 Total: 2.0e-5
 Keys to ignore:
   - Error code
   - Address*
   - date
   - Id
 Patterns to ignore:
   - errcode
   - time
   - Time

#Runs which update and override the default
SiH4:
 #due to lack of functionality in fldiff, since energies field is updated
 Energies: &etol 4.6e-9
 Eion: &eion 3.4e-9
 EH: *etol
 EXC: *etol
 Eion: *etol
 Ekin: *etol
 Enl: *etol
 Epot: *etol
 EvXC: *etol
 Epsilon: 1.4e-10
 Ion-Ion interaction energy: *eion
 Atomic Forces (Ha/Bohr): 2.e-9
 maxval: 2.e-9
 Average noise forces: 1.5e-10
 Average CG stepsize in terms of betax: 1.1e-5

AgBulk:
 Grid Spacing threshold (AU): 1.e-2
 Residues per orbital: 2.2e-8
 EH: 1.6e-11
 EXC: 2.9e-11
 Ekin: 1.2e-11
 Enl: 2.3e-11
 Epot: 2.1e-11
 EvXC: 7.1e-11
 tr(H): 2.52e-11
 # Necessary for GPU runs, to be updated...
 Keys to ignore:
  - Residues per orbital
  - Calculating wavelets expansion of projectors, found warnings

SiBulk:
 Residues per orbital: 8.0e-10
 maxval: 1.2e-11
 Enl: 2.1e-11
 Epot: 1.0e-10
 EvXC: 1.1e-10
 Atomic Forces (Ha/Bohr): 1.2e-11
 Clean forces norm (Ha/Bohr): 1.2e-11
 # Necessary for GPU runs, to be updated...
 Keys to ignore:
  - Residues per orbital

Mn2:
 Keys to ignore:
  - proc
 Epsilon: 2.e-10
 Enl: 3.1e-10
 Ekin: 3.1e-10
 Average noise forces: 3.4e-10
 Atomic Forces (Ha/Bohr):
  - Mn: 2.5e-10
 Clean forces norm (Ha/Bohr):
  maxval: 2.5e-10

GPU:
 EvXC: 1.1e-10

Graphene:
 EH: 1.1e-10

TiMix:
 Epsilon: 1.e-10

GEOPT-BFGS: 
 Epsilon: 2.71e-10

GEOPT-LBFGS: 
 Epsilon: 4.1e-10
 EH: 1.11e-9
 Epot: 3.3e-10
 Eion: 8.5e-10
 Enl: 6.5e-10
 DIIS weights: 1.1e-5
 
NaCl:
 Epsilon: 2.e-9
 Mean L2 norm of gaussian-wavelet difference: 1.21e-4

NH3:
 Epsilon: 1.1e-10

CH3-:
 Epsilon: 5.1e-9
 gnrm: 1.1e-5
 EKS: 1.6e-8
 D: 1.e-8
 Average CG stepsize in terms of betax: 3.4e-4
 Atomic Forces (Ha/Bohr): 4.0e-7
 Average noise forces: 5.3e-8
 Clean forces norm (Ha/Bohr): 3.6e-7
 Raw forces norm (Ha/Bohr): 4.0e-7
 Ion-Ion interaction energy: 3.1e-6
 FORCES norm(Ha/Bohr): 1.1e-6
 Forces: 1.1e-7
 Keys to ignore:
 - b/b0

scalability:
 Energies: 1.e-9
 EKS: 2.0e-10
 Total electronic charge: 1.9e-11

GElecField:
 Epsilon: 1.1e-10 

FeHyb:
 EKS: 6.e-11

Li+:
 EKS: 2.e-11

O2-Spin:
 Epsilon: 1.1e-10

H2-spin:
 Estimation of Finite-Size Corrections:
  Corrected Energies:
   Epot: 2.1e-11
  Total energy with tail correction: 1.51e-11

TiSmear:
 Epsilon: 5.e-11
 EKS: 5.5e-11

H2O-CP2K:
 Total energy with tail correction: 1.8e-11

test.splsad.ref.yaml:
 Epsilon: 1.1e-10
 Electric Dipole Moment (Debye): 1.21e-8

test.minhop.ref.yaml:
 Energies: &etol1 6.0e-9
 Eion: &eion1 4.1e-11
 EH: *etol1
 EXC: *etol1
 Ekin: *etol1
 Enl: *etol1
 Epot: *etol1
 EvXC: *etol1
 EKS: 9.7e-10
 Ion-Ion interaction energy: *eion1
 fluct: 1.2e-9
 maxval: 7.1e-11
 Atomic Forces (Ha/Bohr): 2.0e-11
 Average noise forces: 1.0e-10
 etot: 1.84e-11
 Orbitals: 6.1e-9
 Keys to ignore:
   - (MH) cpu(hrs)
   - WARNINGS

test.testforces.ref.yaml:
 Epsilon: 1.2e-10

H2O-bader:
 Epsilon: 3.0e-11
 EKS: 6.0e-11

H2O-CP2K:
 Total energy with tail correction: 1.8e-11

N2:
 Epsilon: 1.2e-10

mixpotential:
 Epsilon: 2.e-11

IO-wf_plain-read:
 Energies: 1.1e-10

CH4-D3:
 EH: &ener 1.1e-10
 Epot: *ener
 EKS: &ener2 3.3e-11
 Eion: *ener
 Ekin: *ener
 Enl: *ener2
 etot: 2.92e-11
 Etot: 2.9e-11
 Ion-Ion interaction energy: 9.0e-11

NLCC: &NLCCs
 Energies: 1.2e-10
 EKS: 5.e-11
 Total electronic charge: 1.2e-11

NLCC: &NLCCsnew
 EH: 5.1e-10
 EXC: 4.7e-09
 Ekin: 1.3e-09
 Enl: 2.91e-10
 Epot: 1.6e-09
 EvXC: 4.9e-9
 EKS: 4.6e-9
 Orbitals: 1.2e-10
 Atomic Forces (Ha/Bohr): 5.0e-11
 Clean forces norm (Ha/Bohr): 5.0e-11
 Total electronic charge: 1.2e-11
 Value for Exc[rhoc]: 3.8e-9
 PV (Ha): 5.9e-11
 Exc(rhoc): 3.8e-9

#deepcopy of the above defined cases
NLCC_free-O2: *NLCCs
NLCC_free: *NLCCsnew
NLCC_periodic-O2: *NLCCsnew
NLCC_periodic: *NLCCs

taskgroups:
  Energies: 1.1e-10
  EKS: 1.1e-10
  P vector: 1.1e-10

base:
  norm(P): 1.1e-9

Davidson-SiH4:
  e_virtual: 1.7e-11
  Eigenvalues and eigenstate residue: 1.3e-10

TDDFT:
  Epsilon: 1.1e-10
  e_virtual: 1.61e-9
  Eigenvalues and eigenstate residue: 1.1e-7
  Epot: 1.1e-10
  Gradient Norm: 4.11e-9
  L2 Norm - 1 and Rayleigh quotient (Davidson): 1.1e-7
  Excitation Energy and Oscillator Strength: 1.7e-6
  Transition energies (eV): 1.1e-4

BigDFT2Wannier.b2w.ref.yaml:
  amnk_guess(nb): 1.31e-10

cleanup:
 Atomic Forces (Ha/Bohr): 3.1e-10
 Average noise forces: 3.1e-10
 Clean forces norm (Ha/Bohr): 1.6e-10
 Raw forces norm (Ha/Bohr): 2.4e-10

directmin:
 Patterns to ignore:
 - Wavefunction written
 Epsilon: 3.5e-10

experimentalmode:
 Epsilon: 1.e-9

restartdisk_charge:
 Patterns to ignore:
 - Wavefunction written

H2-freq:
 (F) Frequencies (Hartree): 5.e-10
 
rotate_write:
 Patterns to ignore:
 - Wavefunction written

GEOPT-newIG:
  Ion-Ion interaction energy: 2.3e-11
  D: 1.1e-10
  Energies: 1.1e-8
  etot: 1.481e-11
  EKS: 7.4e-10

rotatesmall_write:
  Keys to ignore:
  - Wavefunction written No.

rotatesmall_read:
 Epsilon: 2.4e-11
molecule_dmix:
 Epsilon: 7.0e-11
molecule_pmix:
 Epsilon: 7.0e-11
molecule_dmin:
 Epsilon: 5.0e-11

hybrid-directmin:
 Epsilon: 1.4e-11

cdft_ohoh:
 Epsilon: 7.1e-10
